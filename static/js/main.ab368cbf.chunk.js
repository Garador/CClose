(this.webpackJsonpcorona_close=this.webpackJsonpcorona_close||[]).push([[0],{15:function(e,t,a){e.exports=a(31)},21:function(e,t,a){},22:function(e,t,a){},31:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(12),c=a.n(o),s=a(1),l=a.n(s),i=a(2),u=a(3),m=a(4),d=a(7),h=a(5),f=a(8),p=a(6),v=(a(21),a(22),a(13)),E=a(14),b=function(){function e(){Object(u.a)(this,e)}return Object(m.a)(e,[{key:"getLatestFile",value:function(){var e=Object(i.a)(l.a.mark((function e(){var t,a,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.FILES_LIST_URL);case 2:return t=e.sent,e.t0=JSON,e.next=6,t.text();case 6:e.t1=e.sent,a=e.t0.parse.call(e.t0,e.t1),n={download_url:""},r=a.length-1;case 10:if(!(r>0)){e.next=17;break}if(!(a[r].name.indexOf("csv")>-1)){e.next=14;break}return n=a[r],e.abrupt("break",17);case 14:r--,e.next=10;break;case 17:return e.abrupt("return",n.download_url);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"distance",value:function(e,t,a,n,r){if(e==a&&t==n)return 0;var o=Math.PI*e/180,c=Math.PI*a/180,s=t-n,l=Math.PI*s/180,i=Math.sin(o)*Math.sin(c)+Math.cos(o)*Math.cos(c)*Math.cos(l);return i>1&&(i=1),i=60*(i=180*(i=Math.acos(i))/Math.PI)*1.1515,"K"==r&&(i*=1.609344),"N"==r&&(i*=.8684),i}},{key:"hasGeoLocationActivated",value:function(){var e=Object(i.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!navigator.permissions){e.next=4;break}return e.next=3,new Promise((function(e){navigator.permissions.query({name:"geolocation"}).then((function(t){e("granted"==t.state)}))}));case 3:return e.abrupt("return",e.sent);case 4:return e.abrupt("return",null);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchLocation",value:function(){var e=Object(i.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("geolocation"in navigator)){e.next=7;break}return e.next=3,new Promise((function(e){navigator.geolocation.getCurrentPosition(e)}));case 3:return t=e.sent,e.abrupt("return",{coords:[t.coords.latitude,t.coords.longitude],accuracy:t.coords.accuracy});case 7:window.alert("Gelocation not available for this device");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getNextUrl",value:function(){var e=Object(i.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchData",value:function(){var e=Object(i.a)(l.a.mark((function e(){var t,a=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(){var e=Object(i.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getLatestFile();case 2:n=e.sent,r=(r=n.split("/").pop().split(".")[0]).replace(/-/g,"/").split("/").reverse(),r=E(r).toDate().toLocaleDateString(),v.parse(n,{download:!0,complete:function(e){t(e.data.map((function(e,t){if(t<1)return null;var a={province_state:e[0],country_region:e[1],last_update:e[2],confirmed:parseInt(e[3]),deaths:parseInt(e[4]),recovered:parseInt(e[5]),latitude:parseFloat(e[6]),longitude:parseFloat(e[7]),report_date:r};return a.latitude!=a.latitude?null:a})).filter((function(e){return!!e})))}});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"FILES_LIST_URL",get:function(){return"https://api.github.com/repos/CSSEGISandData/COVID-19/contents/csse_covid_19_data/csse_covid_19_daily_reports"}}],[{key:"instance",get:function(){return window.geo_tool_1||(window.geo_tool_1=new e),window.geo_tool_1}}]),e}(),g=a(10),w=function(e){function t(e){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).call(this,e))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"shareOnFb",value:function(){window.open("https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(window.location.href),"_blank")}},{key:"getTwitterShareURL",value:function(){return"https://twitter.com/intent/tweet?text="+encodeURIComponent("How close are you from the CoronaVirus reported cases? Get the answer on: "+window.location.href)}},{key:"getShareWhatsappLink",value:function(){var e="whatsapp://send?text=How close are you from the CoronaVirus reported cases? Get the answer on: "+window.location.href;return r.a.createElement("a",{href:e,"data-action":"share/whatsapp/share",className:"button",style:{backgroundColor:"#1EBEA5",color:"white",fontWeight:"bold"}},"Whatsapp")}},{key:"render",value:function(){return r.a.createElement("header",{className:"sticky"},r.a.createElement("a",{href:"./",className:"logo"},r.a.createElement("b",null,"CClose")),r.a.createElement("label",{htmlFor:"modal-control",className:"button"},"Share"),r.a.createElement("a",{href:"mailto:azolotdev@gmail.com",className:"button"},"Contact"),r.a.createElement("input",{type:"checkbox",id:"modal-control",className:"modal"}),r.a.createElement("div",null,r.a.createElement("div",{className:"card"},r.a.createElement("label",{htmlFor:"modal-control",className:"modal-close"}),r.a.createElement("h3",{className:"section",style:{paddingBottom:"1em"}},"Share via"),r.a.createElement("a",{className:"button",href:this.getTwitterShareURL(),style:{backgroundColor:"#1DA1F2",color:"white",fontWeight:"bold"}},"Twitter"),this.getShareWhatsappLink(),r.a.createElement("button",{className:"button",onClick:this.shareOnFb,style:{backgroundColor:"#3C5A9A",color:"white",fontWeight:"bold"}},"Facebook"))))}}]),t}(r.a.Component),y=function(e){function t(e){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).call(this,e))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(g.Helmet,null,r.a.createElement("meta",{charSet:"utf-8"}),r.a.createElement("title",null,"CClose: Closes CoronaVirus case"),r.a.createElement("link",{rel:"canonical",href:"./"}),r.a.createElement("link",{rel:"icon",type:"image/png",href:"./virus_icon.png",sizes:"16x16"}),r.a.createElement("meta",{name:"description",content:"Closes Coronavirus to your location. Daily report"}))}}]),t}(r.a.Component),k=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={cases:[],closest:null,loading:!1,error:null,geolocationPermission:null},a.loadData=a.loadData.bind(Object(f.a)(a)),a.loadGeoPermissionStatus=a.loadGeoPermissionStatus.bind(Object(f.a)(a)),a.loadGeoPermissionStatus().then((function(){!1!==a.state.geolocationPermission&&a.loadData()})),a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"loadGeoPermissionStatus",value:function(){var e=Object(i.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.instance.hasGeoLocationActivated();case 3:t=e.sent,this.setState({geolocationPermission:t}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log({err:e.t0}),this.setState({geolocationPermission:null});case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadData",value:function(){var e=Object(i.a)(l.a.mark((function e(){var t,a,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new b,this.setState({loading:!0}),e.prev=2,e.next=5,Promise.all([t.fetchData(),t.fetchLocation()]);case 5:a=e.sent,n=a[0],r=a[1],n=n.map((function(e){var a=t.distance(r.coords[0],r.coords[1],e.latitude,e.longitude,"K");return e.distance_from_user=Math.round(100*a)/100,e})).sort((function(e,t){return e.distance_from_user>t.distance_from_user?1:e.distance_from_user<t.distance_from_user?-1:0})),console.log({cases:n}),this.setState({cases:n,closest:n[0],loading:!1}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),console.log({e:e.t0}),this.setState({loading:!1,error:e.t0});case 17:case"end":return e.stop()}}),e,this,[[2,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"getAuthorizedScreen",value:function(){var e=this.state.cases.filter((function(e,t){return t>1})).map((function(e,t){return r.a.createElement("tr",{key:"LAT=".concat(e.latitude,";LONG=").concat(e.longitude,";").concat(t)},r.a.createElement("td",{"data-label":"Location"},e.country_region," ",r.a.createElement("small",null,e.province_state)),r.a.createElement("td",{"data-label":"Distance Away"},e.distance_from_user," km"),r.a.createElement("td",{"data-label":"Confirmed"},e.confirmed),r.a.createElement("td",{"data-label":"Deaths"},e.deaths),r.a.createElement("td",{"data-label":"Recovered"},e.recovered))})),t="";return this.state.closest&&(t=r.a.createElement("div",{className:"card error",style:{maxWidth:"100%"}},r.a.createElement("h2",null,this.state.closest.distance_from_user," km ",r.a.createElement("small",{style:{color:"white"}},this.state.closest.country_region," ",this.state.closest.province_state?"-"+this.state.closest.province_state:"")),r.a.createElement("div",null,r.a.createElement("p",null,"Confirmed: ",this.state.closest.confirmed),r.a.createElement("p",null,"Deaths: ",this.state.closest.deaths),r.a.createElement("p",null,"Recovered: ",this.state.closest.recovered)))),r.a.createElement("div",{className:"App"},r.a.createElement(w,null),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("h1",null,"CC: CoronaClose",r.a.createElement("small",null,"How close are you from the ",r.a.createElement("span",{style:{color:"red"}},"Corona VID-19")," cases?")),r.a.createElement("h2",null,"Closest case to you (at ",this.state.closest.report_date,")"),r.a.createElement("small",null,r.a.createElement("a",{href:"https://github.com/CSSEGISandData/COVID-19"},"Information Source")))),r.a.createElement("div",{className:"row"},t||""),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12 col-md-12 col-sm-first"},r.a.createElement("h3",null,"Next Closest Cases"),r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Location"),r.a.createElement("th",null,"Distance"),r.a.createElement("th",null,"Confirmed"),r.a.createElement("th",null,"Deaths"),r.a.createElement("th",null,"Recovered"))),r.a.createElement("tbody",null,e))))))}},{key:"getNotLoadedScreen",value:function(){return r.a.createElement("div",{className:"row",style:{justifyContent:"center"}},r.a.createElement("div",{className:"card",style:{textAlign:"center"}},r.a.createElement("h1",null,"Note: You must enable location in order to get the data"),r.a.createElement("button",{className:"button",onClick:this.loadData},"Begin")))}},{key:"getLoadingScreen",value:function(){return r.a.createElement("div",{className:"row",style:{justifyContent:"center"}},r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("h1",null,"Loading...")))}},{key:"getErrorScreen",value:function(){return r.a.createElement("div",{className:"row",style:{justifyContent:"center"}},r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("h1",null,"An error has occurred. Please try again later and try cleaning your browser cache."),r.a.createElement("button",{className:"button",onClick:this.loadData},"Try Again")))}},{key:"render",value:function(){return this.state.closest?r.a.createElement("div",null,r.a.createElement(y,null),this.getAuthorizedScreen()):this.state.loading?r.a.createElement("div",null,r.a.createElement(y,null),this.getLoadingScreen()):this.state.error?r.a.createElement("div",null,r.a.createElement(y,null),this.getErrorScreen()):r.a.createElement("div",null,r.a.createElement(y,null),this.getNotLoadedScreen())}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[15,1,2]]]);
//# sourceMappingURL=main.ab368cbf.chunk.js.map